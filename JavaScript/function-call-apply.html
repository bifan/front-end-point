<!DOCTYPE html>
<html lang="zh">
  <head>
    <title>å®ç° call/apply</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
  </head>
  <body>
    <script>
      // obj é»˜è®¤ä¸ºwindow, å¯ä»¥çœ‹åˆ°å…¨å±€å˜é‡çš„ç¼ºé™·
      // è«åå…¶å¦™å°±è¢«æ›¿æ¢, ç”šè‡³åˆ æ‰äº†ğŸ™
      function noSoul(obj = window, ...args) {
        const _function = this;
        const _functionName = this.name;
        // åå­—å¯èƒ½éœ€è¦ç”¨Symbol()ä¸€ç±»çš„å”¯ä¸€å€¼
        // å› ä¸ºè‡ªå·±å¯èƒ½æœ‰åŒåå‡½æ•°, ä½†æ˜¯æƒ³ç”¨åˆ«äººçš„
        obj[_functionName] = _function;
        obj[_functionName](...args);
        delete obj[_functionName];
      }

      Function.prototype._call = noSoul;
      Function.prototype._apply = function (obj, array){
        // æŠŠapply å½“ä½œcall æ¥ä½¿ç”¨
        // ç”±äºåµŒå¥—äº†å‡½æ•°, å…ˆä½¿ç”¨call ä¿ä½this
        // ä¸ç„¶noSoul ä¸­çš„this ä¼šæŒ‡å‘window
        noSoul._call(this, obj, ...array);
      };

      // test
      const Dog = {
        name: "Dog",
        do(a, b, c) {
          console.log(`${this.name} is eating`);
          console.log(a, b, c);
        }
      };
      const Cat = {
        name: "Cat"
      };

      Dog.do._call(Cat, 1, 2, 3);
      Dog.do._apply(Cat, [1, 2, 3]);
    </script>
    </script>
    <script>
      // æŸ¥çœ‹call çš„è¡Œä¸º
      // const Dog = {
      //   name: "Dog",
      //   do() {
      //     console.log(`${this.name} is eating`);
      //   }
      // };
      // const Cat = {
      //   name: "Cat"
      // };
      // Dog.do.call(Cat);
    </script>
  </body>
</html>
