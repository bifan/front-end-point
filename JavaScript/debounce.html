<!DOCTYPE html>
<body>
  <p>防抖(debounce), 500毫秒后在控制台打印input 的值</p>
  <input type="text" />
  <script>
    /**
      中英对照
        debounce /di'bauns/ 防反跳 防抖动
        bounce /baʊns/ 弹起；反弹；蹦跳；晃动；颠簸
      目的
        对于非常频繁触发的事件, 减少回调函数的执行次数以优化性能
        scroll, resize, input 等事件
      做法
        延迟执行函数, 频繁触发事件时, 删除前一次timeout, 加入新的timeout
     */

    // 产生一个延迟执行的回调函数, 可以取消执行
    function debounce(callbackFunction, delay) {
      // 闭包产生专用全局变量
      let timer = null;
      // 返回一个延迟执行的函数, 接收浏览器传入的参数
      return event => {
        // 清除已有的延迟执行函数
        clearTimeout(timer);
        // 产生新的延迟执行函数
        timer = window.setTimeout(() => {
          callbackFunction.call(this, event);
        }, delay);
      };
    }
    const inputElement = document.querySelector("input");
    // 给回调函数套一个计时器
    const debouncedFunction = debounce(
      event => console.log("debounced: ", event.target.value),
      500
    );
    inputElement.addEventListener("input", debouncedFunction);
  </script>
</body>
