<!DOCTYPE html>
<html lang="zh">
  <head>
    <title>input äº‹ä»¶</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
  </head>
  <body>
    <header>
      <h1>ç›‘å¬ä¸­æ–‡è¾“å…¥ compositionstart/update/end</h1>
      <p>compositionstart â†’ å¼€å§‹è¾“å…¥æ‹¼éŸ³æ—¶è§¦å‘</p>
      <p>compositionupdate â†’ æ¯è¾“å…¥ä¸€ä¸ªæ‹¼éŸ³è§¦å‘ä¸€æ¬¡</p>
      <p>compositionend â†’ ä¸­æ–‡ä¸Šå±åè§¦å‘ä¸€æ¬¡(å–æ¶ˆä¸­æ–‡è¾“å…¥ä¹Ÿä¼šè§¦å‘)</p>
    </header>
    <main>
      <p>
        <span></span><br /><input
          type="text"
          autocapitalize="none"
          id="compositionstart"
        /><span></span><span></span><br /><span></span>
      </p>
    </main>
    <footer>
      <p>
        é‚£ä¹ˆ, ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨compositionEvent ä»£æ›¿input å‘¢?<br />
        å› ä¸ºcompositionEvent å¯¹è‹±æ–‡è¾“å…¥æ²¡ååº”<br />
        åªå¯¹å¤–æŒ‚è¾“å…¥æ³•çŠ¯ç¡¬(ä¸­/æ—¥å­—ç¬¦) ( ... å’¦?ğŸ§ )<br />
        äºæ˜¯ä¹<br />
        åœ¨è¾“å…¥ä¸­æ–‡æ—¶<br />
        åœ¨compositionstart é‡Œé¢ç«‹flag è®©input ä¼‘æ¯, åœ¨compositionend
        é‡Œé¢åŠä¸­æ–‡æ­£äº‹å¹¶è®©input é†’æ¥<br />
        input å”§å”§åº”å¯¹è‹±æ–‡
      </p>
    </footer>
    <script>
      const counter = {
        input: 0,
        change: 0,
        compositionstart: 0,
        compositionupdate: 0,
        compositionend: 0
      };

      const input = document.querySelector("input");
      const inputStart = input.previousElementSibling.previousElementSibling;
      const inputting = input.nextElementSibling;
      const inputUpdate = input.nextElementSibling.nextElementSibling;
      const inputEnd =
        input.nextElementSibling.nextElementSibling.nextElementSibling
          .nextElementSibling;

      input.addEventListener("change", function (event) {
        inputting.innerHTML = `${event.type} Ã— ${++counter[event.type]}; `;
        console.log('"input":', "input");
      });
      input.addEventListener("compositionstart", function (event) {
        inputStart.innerHTML = `${event.type} Ã— ${++counter[event.type]}`;
      });
      input.addEventListener("compositionupdate", function (event) {
        inputUpdate.innerHTML = `${event.type} Ã— ${++counter[event.type]}`;
      });
      input.addEventListener("compositionend", function (event) {
        inputEnd.innerHTML = `${event.type} Ã— ${++counter[event.type]}`;
        console.log("compositionend:", "compositionend");
      });
    </script>
  </body>
</html>
